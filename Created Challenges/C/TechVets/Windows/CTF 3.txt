//CTF Demo 3 - PRET(P1NK_L0V35_????_F14G_P74Y) 
#include <stdio.h>
#include <string.h>

int main() {
	char guess[10];
	char hidden[13] = "ABCDEF123456";
	char pass_first[7] = "ABC123";
	char pass_second[7] = "123ABC";
	char pass_third[9] = "QWERASDF";
	char pass_fourth = "12345678";
	char half_flag[17] = "PRET(P1NK_L0V35_";
	printf("Enter the password : ");
	fgets(guess, 10, stdin);
	guess[strlen(guess) - 1] = '\0'; // Removes the \n on fgets and allows genuine compares
	size_t lenguess = strlen(guess);

	// Checks guess length. If < or > 6, fails. If 6, checks if valid answer.
	if (lenguess < 6) {
		printf("\nNo cookie for you!\n");
	}

	else if (lenguess == 6) {
		if (strcmp(guess, passme) == 0) {
			printf("Have a cookie, and half a flag\n");
			printf("Is has been said that _%c%c%c%c_F14G_P74Y) is the answer you're looking for\n", hidden[2], hidden[4], hidden[8], hidden[11]); //CE36 output
			return 0;
		}
		else {
			printf("\nNo cookie for you!\n");
		}
	}	else if (lenguess > 6) {
		printf("\nNo cookie for you!\n");
	}
	main();
}
